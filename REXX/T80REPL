/* REXX THE WONDER DOG */
ARG ACID PROFOLD PROFNEW
SAY ACID PROFOLD PROFNEW
PROFHOLD = PROFNEW /* SAVE ORIGINAL PARM FOR T80INS */
PROFNEW = TRANSLATE(PROFNEW," ",".") /* REPLACE DOTS WITH SPACES */
PROFNEW = TRANSLATE(PROFNEW," ","_") /* REPLACE BARS WITH SPACES */
SAY "T80REPL: " ACID PROFOLD PROFNEW
ADDRESS ISPEXEC
/********************************************************************/
/***  THIS EXEC REPLACES ONE PROFILE IN A TOP SECRET ACID WITH    ***/
/***  ONE OR MORE OTHER PROFILES. IT REQUIRES THAT T80INS         ***/
/***  BE AVAILABLE TO DO INSERTIONS.....DIR 26 APRIL 93           ***/
/********************************************************************/
WORDNUM = WORDS(PROFOLD)
IF WORDNUM > 1 THEN DO
  SECRC = "YOU MUST SPECIFY ONLY 1 PROFILE FOR REPLACEMENT"
  "VPUT SECRC PROFILE"
  EXIT
END
SAY "T80REPL: CALLING T80FLOC"
ADDRESS TSO "%T80FLOC" ACID PROFOLD
SAY "T80REPL: BACK FROM T80FLOC"
" VGET SECRC PROFILE"
PLACE = SECRC
SAY " PLACE IS " PLACE
IF (PLACE = "ERROR") | ( PLACE= 0 ) THEN DO
  SECRC = "ERROR LOCATING "PROFOLD "IN ACID.. REPLACE ABORTED."
  "VPUT SECRC PROFILE"
  EXIT
END
ADDRESS TSO "TSS REM("ACID") PROF("PROFOLD")"
SIGNAL ON ERROR NAME BADPROF
SAY "T80REPL: CALLING T80INS"
ADDRESS TSO "%T80INS" ACID PROFHOLD PLACE
SECRC = "PROFILE REPLACE COMPLETED."
  "VPUT SECRC PROFILE"
  EXIT 00
BADPROF: NOP
SECRC = PROFOLD "WAS IN PLACE "PLACE", HOWEVER INSERTION OF ",
  PROFNEW "FAILED!"
  "VPUT SECRC PROFILE"
